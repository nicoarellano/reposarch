const places = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>I. CHAMONIX, FRANCE</strong><p> Date: January 25 - February 4th, 1924. First Ever Winter Olympics. First gold medal won by Charles Jewtraw</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [6.880297848066675, 45.92484674639669],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>II. St. Moritz, Switzerland</strong><p>February 11-19, 1928. Canada won its only gold medal in Hockey</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [9.838204269146525, 46.49171108316548],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>III. Lake Placid, New York</strong><p> February 4-15, 1932. Canada won a total of 7 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-73.97771866223762, 44.279352038627636],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>IV. Garmisch Partenkirchen, Germany<p> February 6-16, 1936. Norway won a total of 15 medals, whereas Canada won a single sliver medal</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [11.07368396902991, 47.49179733175563],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>V. St. Moritz, Switzerland</strong><p>January 30-February 8, 1948. Second time hosting the Winter Olympics. Norway, Sweden and Swtizerland tied at 10 medals each.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [9.84232414200101, 46.486274443846234],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>VI. Oslo, Norway</strong><p>February 14-25, 1952. Norway won a total of 16 medals, whereas Canada won 2 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [10.741857835027892, 59.9136534162078],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>VII. Cortina dAmpezzo, Italy </strong><p>January 26-February 5, 1956. USSR won a total of 16 medals. Canada won 3 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [12.135788367980394, 46.54002979212263],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>VIII. Squaw Valley, California</strong><p>) February 18-28, 1960. USSR won a total of 21 medals. Canada won a total of 4 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-120.23741392406491, 39.197535741344],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>IX. Innsbruck, Austria</strong><p>January 29-February 9, 1964. USSR won a total of 25 medals. Canada won a total of 3 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [11.395269441417945, 47.267985289810824],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>X.Grenoble, France</strong><p>February 6-18, 1968. Norway won a total of 14 medals. Canada won a total of 3 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [5.720518179699171, 45.188649336358374],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XI. Sapporo, Japan</strong><p>February 3-13, 1972. USSR won a total of 16 medals. Canada only won a single silver medal</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [141.34684944850764, 43.071169484672986],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XII. Innsbruck, Austria</strong><p>February 4-15, 1976. Second time hosting the Winter Olympics. USSR won a total of 27 medals. Canada won a total of 3 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [11, 47],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XIII. Lake Placid, New York</strong><p>February 14-23, 1980. Second time hosting the Winter Olympics. USSR won a total of 22 medals. Canada won a total of 2 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-73, 44],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XIV. Sarajevo, Yugoslavia</strong><p>February 7-19, 1984. USSR won a total of 25 medals. German Democratic Republic won a total of 24 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [18.422816937593367, 43.85833349484494],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XV. Calgary, Canada</strong><p>February 13-28, 1988. USSR won a total of 29 medals. German Democratic Republic won a total of 25 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-114.09470145475748, 51.04532628856419],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XVI. Albertville, France</strong><p>February 8-23, 1992. Germany won a total of 26 medals. Olympic Unified Team won a total of 23 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [6.393354097213117, 45.67531103798614],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XVII. Lillehammer, Norway</strong><p>February 12-27, 1994. Norway won a total of 26 medals. Canada won a total of 13 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [10.463139895125911, 61.115811087159074],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XVIII. Nagano, Japan</strong><p>February 7-22, 1998. Germany won a total of 29 medals. Canada won a total of 15 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [138.16807204710832, 36.68184228849147],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XIX. Salt Lake City, Utah</strong><p>February 8-24, 2002. Germany won a total of 36 medals. USA won a total of 34 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-111.90537884953355, 40.76022686400715],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XX. Turin, Italy</strong><p>February 10-26, 2006. Germany won a total of 29 medals. Canada won a total of 24 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [7.687622845825586, 45.071185388051084],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XXI. Vancouver, Canada</strong><p>February 12-28, 2010. USA won a total of 37 medals. Canada won a total of 26 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-123.11944080440763, 49.28248921281115],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XXII. Sochi, Russia</strong><p>February 7-23, 2014. USA won a total of 28 medals. Canada won a total of 25 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [39.73783189130133, 43.60159719109201],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XXIII. Pyeongchang, South Korea</strong><p>February 9-25, 2018. Norway won a total of 39 medals. Canada won a total of 29 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [128.66756161385578, 37.65870508362179],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Winter",
        description:
          "<strong>XXIV. Beijing, China</strong><p>February 4-20, 2022. ROC won a total of 32 medals. Canada won a total of 26 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [116.37136637192158, 39.90149411783453],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>I. Athens, Greece</strong><p>April 6-15, 1896. First Modern Olympic Games. Greece won a total of 47 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [23.723228082141073, 37.98972615115778],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>II. Paris, France</strong><p>May 20-October 28, 1900. USA won 51 total medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [2.338108608815279, 48.85456299151211],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>III. St. Louis, Missouri, USA</strong><p>July 1-November 23, 1904. USA won a total of 249 medals (81 gold, 85 silver, 83 bronze).</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-90.20638314430963, 38.62869781837428],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>IV. London, England</strong><p>April 27-October 31, 1908. UK won a total of 146 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-0.09610548619401796, 51.50172146952439],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>V. Stockholm, Sweden</strong><p>May 5-July 22, 1912. Sweden won a total of 65 medals. USA won a total of 64 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [18.041104010914303, 59.33349729794552],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>VII. Antwerp, Belgium</strong><p>April 20-September 12, 1920. USA won a total of 95 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [4.390044987360144, 51.22458721700494],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>VIII. Paris, France</strong><p>May 4-July 27, 1924. Second Summer Olympics held in Paris. USA won a total of 99 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [2.2872968436099455, 48.87308311639435],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>IX. Amsterdam, Netherlands</strong><p>May 17-August 12, 1928. USA won a total of 56 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [4.901213818097009, 52.36745500328382],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>X. Los Angeles, California, USA</strong><p>July 30-August 14, 1932. USA won a total of 110 medals (44 gold, 36 silver, 30 bronze).</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-118.30186922388035, 34.06713381423162],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XI. Berlin, Germany</strong><p>August 1-16, 1936.Germany won a total of 101 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [13.404132385727566, 52.51896263730516],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XIV. London, England</strong><p>July 29-August 14, 1948. Second Summer Olympics held in London. USA won a total of 84 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-0.07688850237597444, 51.519611527419976],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XV. Helsinki, Finland</strong><p>July 19-August 3, 1952. USA won a total of 76 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [24.932163020055782, 60.1747721147704],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XVI. Melbourne, Australia</strong><p>November 22-December 8, 1956. USSR won a total of 98 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [144.9515117695893, -37.802405911712334],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XVII. Rome, Italy</strong><p>August 25-September 11, 1960. USSR won a total of 103 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [12.481950817164106, 41.903954122355685],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XVIII. Tokyo, Japan</strong><p>October 10-24, 1964. USSR won a total of 96 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [139.70389413432824, 35.823865527199075],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XIX. Mexico City, Mexico</strong><p>October 12-27, 1968. USA won a total of 107 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-99.18007926902989, 19.43126302677155],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XX. Munich, Germany</strong><p>August 26-September 10, 1972. USSR won a total of 99 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [11.583721124020613, 48.13681362863852],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXI. Montreal, Canada</strong><p>July 17-August 1, 1976. USSR won a total of 125 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-73.5553181815295, 45.49905430493114],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXII. Moscow, Soviet Union</strong><p>July 19-August 3, 1980. USSR won a total of 195 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [37.5997568884333, 55.81883134486111],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXIII. Los Angeles, California, USA</strong><p>July 28-August 12, 1984. Second Summer Olympics to take place in Los Angeles. USA won a total of 174 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-118.19475252966369, 34.162639081390076],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXIV. Seoul, Republic of Korea</strong><p>September 17-October 2, 1988. USSR won a total of 132 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [127.00229176450564, 37.55970527155951],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXV. Barcelona, Spain</strong><p>July 25-August 9, 1992. USA won a total of 108 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [2.165594982602667, 41.38983473656209],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXVI. Atlanta, Georgia, USA</strong><p>July 19-August 9, 1996. USA won a total of 101 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-84.39197808549434, 33.75281062922303],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXVII. Sydney, Australia</strong><p>September 15-October 1, 2000. USA won a total of 93 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [151.19015344888112, -33.863639849898306],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXVIII. Athens, Greece</strong><p>August 13-29, 2004. Second Summer Olympics in Athens. USA won a total of 101 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [23.700917171571746, 37.95118713475103],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXIX. Beijing, China</strong><p>August 8-24, 2008. Only city to have hosted Summer and Winter Olympics. USA won a total of 112 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [116.6852302268691, 39.58299087397424],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXX. London, Great Britain</strong><p>July 27- August 12, 2012. Second time to host the Summer Olympics. USA won a total of 104 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-0.17863180956325783, 51.50292958390606],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXXI. Rio de Janeiro, Brazil</strong><p>August 5-21, 2016. USA won a total of 121 medals.</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [-43.239988407275675, -22.909703444454244],
      },
    },
    {
      type: "Feature",
      properties: {
        icon: "Summer",
        description:
          "<strong>XXXII. Tokyo, Japan</strong><p>Jul 23, 2021-Aug 8, 2021. USA won a total of 113 medals</p>",
      },
      geometry: {
        type: "Point",
        coordinates: [139.66544198768634, 35.61871879420075],
      },
    },
  ],
};

const map = new maplibregl.Map({
  container: "map",
  style:
    "https://api.maptiler.com/maps/dataviz/style.json?key=l4fTgpopGsERnO5dl5sJ",
  center: [-12.140143650680095, 18.972594621388026],
  zoom: 2,
});

map.on("load", () => {
  map.addSource("places", {
    type: "geojson",
    data: places,
  });

  // Add a layer showing the places with a generic marker.
  map.addLayer({
    id: `places`,
    type: "circle",
    source: "places",
    paint: {
      "circle-color": "red",
      "circle-radius": 6,
      "circle-stroke-width": 2,
      "circle-stroke-color": "white",
    },
  });

  // Create a popup, but don't add it to the map yet.
  const popup = new maplibregl.Popup({
    closeButton: false,
    closeOnClick: false,
  });

  map.on("mouseenter", "places", (e) => {
    // Change the cursor style as a UI indicator.
    map.getCanvas().style.cursor = "pointer";

    const coordinates = e.features[0].geometry.coordinates.slice();
    const description = e.features[0].properties.description;

    // Populate the popup and set its coordinates
    // based on the feature found.
    popup.setLngLat(coordinates).setHTML(description).addTo(map);
  });

  map.on("mouseleave", "places", () => {
    map.getCanvas().style.cursor = "";
    popup.remove();
  });

  const filterGroup = document.getElementById("filter-group");

  // Create an array to store unique seasons (summer and winter)
  const seasons = Array.from(
    new Set(places.features.map((feature) => feature.properties.icon))
  );

  // Initialize a counter to keep track of selected seasons
  let selectedSeasonCount = seasons.length;

  // Iterate through each season and create a checkbox and label
  seasons.forEach((season) => {
    const input = document.createElement("input");
    input.type = "checkbox";
    input.id = season;
    input.checked = true;
    filterGroup.appendChild(input);

    const label = document.createElement("label");
    label.setAttribute("for", season);
    label.textContent = season;
    filterGroup.appendChild(label);

    input.addEventListener("change", () => {
      // Update the counter based on checkbox state
      selectedSeasonCount += input.checked ? 1 : -1;

      // Update the filter based on the selected seasons
      const filter =
        selectedSeasonCount === seasons.length
          ? ["has", "icon"]
          : [
              "in",
              ["get", "icon"],
              ...seasons.filter((s) => document.getElementById(s).checked),
            ];
      map.setFilter("places", filter);

      // Update the visibility of the layer
      map.setLayoutProperty("places", "visibility", "visible");
    });
  });
});
